!function(t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(t):"undefined"!=typeof window?window.decomp=t():"undefined"!=typeof global?global.decomp=t():"undefined"!=typeof self&&(self.decomp=t())}(function(){return function t(e,i,r){function n(s,h){var a,f;if(!i[s]){if(!e[s]){a="function"==typeof require&&require;if(!h&&a)return a(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}f=i[s]={exports:{}};e[s][0].call(f.exports,function(t){var i=e[s][1][t];return n(i?i:t)},f,f.exports,t,e,i,r)}return i[s].exports}var s,o="function"==typeof require&&require;for(s=0;s<r.length;s++)n(r[s]);return n}({1:[function(t,e,i){function r(){}var n=t("./Scalar");e.exports=r;r.lineInt=function(t,e,i){var r,s,o,h,a,f,c,u;i=i||0;r=[0,0];s=t[1][1]-t[0][1];o=t[0][0]-t[1][0];h=s*t[0][0]+o*t[0][1];a=e[1][1]-e[0][1];f=e[0][0]-e[1][0];c=a*e[0][0]+f*e[0][1];u=s*f-a*o;if(!n.eq(u,0,i)){r[0]=(f*h-o*c)/u;r[1]=(s*c-a*h)/u}return r};r.segmentsIntersect=function(t,e,i,r){var n,s,o=e[0]-t[0],h=e[1]-t[1],a=r[0]-i[0],f=r[1]-i[1];if(a*h-f*o==0)return!1;n=(o*(i[1]-t[1])+h*(t[0]-i[0]))/(a*h-f*o);s=(a*(t[1]-i[1])+f*(i[0]-t[0]))/(f*o-a*h);return n>=0&&n<=1&&s>=0&&s<=1}},{"./Scalar":4}],2:[function(t,e,i){function r(){}e.exports=r;r.area=function(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])};r.left=function(t,e,i){return r.area(t,e,i)>0};r.leftOn=function(t,e,i){return r.area(t,e,i)>=0};r.right=function(t,e,i){return r.area(t,e,i)<0};r.rightOn=function(t,e,i){return r.area(t,e,i)<=0};var n=[],s=[];r.collinear=function(t,e,i,o){var h,a,f,c,u,p;if(o){h=n,a=s;h[0]=e[0]-t[0];h[1]=e[1]-t[1];a[0]=i[0]-e[0];a[1]=i[1]-e[1];f=h[0]*a[0]+h[1]*a[1],c=Math.sqrt(h[0]*h[0]+h[1]*h[1]),u=Math.sqrt(a[0]*a[0]+a[1]*a[1]),p=Math.acos(f/(c*u));return p<o}return 0==r.area(t,e,i)};r.sqdist=function(t,e){var i=e[0]-t[0],r=e[1]-t[1];return i*i+r*r}},{}],3:[function(t,e,i){function r(){this.vertices=[]}function n(t,e,i,r,n){var s,o,h,a,c,u,p;n=n||0;s=e[1]-t[1];o=t[0]-e[0];h=s*t[0]+o*t[1];a=r[1]-i[1];c=i[0]-r[0];u=a*i[0]+c*i[1];p=s*c-a*o;return f.eq(p,0,n)?[0,0]:[(c*h-o*u)/p,(s*u-a*h)/p]}var s,o,h=t("./Line"),a=t("./Point"),f=t("./Scalar");e.exports=r;r.prototype.at=function(t){var e=this.vertices,i=e.length;return e[t<0?t%i+i:t%i]};r.prototype.first=function(){return this.vertices[0]};r.prototype.last=function(){return this.vertices[this.vertices.length-1]};r.prototype.clear=function(){this.vertices.length=0};r.prototype.append=function(t,e,i){if("undefined"==typeof e)throw new Error("From is not given!");if("undefined"==typeof i)throw new Error("To is not given!");if(i-1<e)throw new Error("lol1");if(i>t.vertices.length)throw new Error("lol2");if(e<0)throw new Error("lol3");for(var r=e;r<i;r++)this.vertices.push(t.vertices[r])};r.prototype.makeCCW=function(){var t,e=0,i=this.vertices;for(t=1;t<this.vertices.length;++t)(i[t][1]<i[e][1]||i[t][1]==i[e][1]&&i[t][0]>i[e][0])&&(e=t);a.left(this.at(e-1),this.at(e),this.at(e+1))||this.reverse()};r.prototype.reverse=function(){var t,e,i=[];for(t=0,e=this.vertices.length;t!==e;t++)i.push(this.vertices.pop());this.vertices=i};r.prototype.isReflex=function(t){return a.right(this.at(t-1),this.at(t),this.at(t+1))};s=[],o=[];r.prototype.canSee=function(t,e){var i,r,n,f=s,c=o;if(a.leftOn(this.at(t+1),this.at(t),this.at(e))&&a.rightOn(this.at(t-1),this.at(t),this.at(e)))return!1;r=a.sqdist(this.at(t),this.at(e));for(n=0;n!==this.vertices.length;++n)if((n+1)%this.vertices.length!==t&&n!==t&&a.leftOn(this.at(t),this.at(e),this.at(n+1))&&a.rightOn(this.at(t),this.at(e),this.at(n))){f[0]=this.at(t);f[1]=this.at(e);c[0]=this.at(n);c[1]=this.at(n+1);i=h.lineInt(f,c);if(a.sqdist(this.at(t),i)<r)return!1}return!0};r.prototype.copy=function(t,e,i){var n,s=i||new r;s.clear();if(t<e)for(n=t;n<=e;n++)s.vertices.push(this.vertices[n]);else{for(n=0;n<=e;n++)s.vertices.push(this.vertices[n]);for(n=t;n<this.vertices.length;n++)s.vertices.push(this.vertices[n])}return s};r.prototype.getCutEdges=function(){var t,e,i,n=[],s=[],o=[],h=new r,a=Number.MAX_VALUE;for(t=0;t<this.vertices.length;++t)if(this.isReflex(t))for(e=0;e<this.vertices.length;++e)if(this.canSee(t,e)){s=this.copy(t,e,h).getCutEdges();o=this.copy(e,t,h).getCutEdges();for(i=0;i<o.length;i++)s.push(o[i]);if(s.length<a){n=s;a=s.length;n.push([this.at(t),this.at(e)])}}return n};r.prototype.decomp=function(){var t=this.getCutEdges();return t.length>0?this.slice(t):[this]};r.prototype.slice=function(t){var e,i,r,n,s,o;if(0==t.length)return[this];if(t instanceof Array&&t.length&&t[0]instanceof Array&&2==t[0].length&&t[0][0]instanceof Array){e=[this];for(i=0;i<t.length;i++){r=t[i];for(n=0;n<e.length;n++){s=e[n];o=s.slice(r);if(o){e.splice(n,1);e.push(o[0],o[1]);break}}}return e}r=t;i=this.vertices.indexOf(r[0]);n=this.vertices.indexOf(r[1]);return-1!=i&&-1!=n?[this.copy(i,n),this.copy(n,i)]:!1};r.prototype.isSimple=function(){var t,e,i=this.vertices;for(t=0;t<i.length-1;t++)for(e=0;e<t-1;e++)if(h.segmentsIntersect(i[t],i[t+1],i[e],i[e+1]))return!1;for(t=1;t<i.length-2;t++)if(h.segmentsIntersect(i[0],i[i.length-1],i[t],i[t+1]))return!1;return!0};r.prototype.quickDecomp=function(t,e,i,s,o,h){var f,c,u,p,l,v,g,d,y,m,q,w,x,E,O,A;o=o||100;h=h||0;s=s||25;t="undefined"!=typeof t?t:[];e=e||[];i=i||[];f=[0,0],c=[0,0],u=[0,0];p=0,l=0,v=0,g=0;d=0,y=0,m=0;q=new r,w=new r;x=this,E=this.vertices;if(E.length<3)return t;h++;if(h>o){console.warn("quickDecomp: max level ("+o+") reached.");return t}for(O=0;O<this.vertices.length;++O)if(x.isReflex(O)){e.push(x.vertices[O]);p=l=Number.MAX_VALUE;for(A=0;A<this.vertices.length;++A){if(a.left(x.at(O-1),x.at(O),x.at(A))&&a.rightOn(x.at(O-1),x.at(O),x.at(A-1))){u=n(x.at(O-1),x.at(O),x.at(A),x.at(A-1));if(a.right(x.at(O+1),x.at(O),u)){v=a.sqdist(x.vertices[O],u);if(v<l){l=v;c=u;y=A}}}if(a.left(x.at(O+1),x.at(O),x.at(A+1))&&a.rightOn(x.at(O+1),x.at(O),x.at(A))){u=n(x.at(O+1),x.at(O),x.at(A),x.at(A+1));if(a.left(x.at(O-1),x.at(O),u)){v=a.sqdist(x.vertices[O],u);if(v<p){p=v;f=u;d=A}}}}if(y==(d+1)%this.vertices.length){u[0]=(c[0]+f[0])/2;u[1]=(c[1]+f[1])/2;i.push(u);if(O<d){q.append(x,O,d+1);q.vertices.push(u);w.vertices.push(u);0!=y&&w.append(x,y,x.vertices.length);w.append(x,0,O+1)}else{0!=O&&q.append(x,O,x.vertices.length);q.append(x,0,d+1);q.vertices.push(u);w.vertices.push(u);w.append(x,y,O+1)}}else{y>d&&(d+=this.vertices.length);g=Number.MAX_VALUE;if(d<y)return t;for(A=y;A<=d;++A)if(a.leftOn(x.at(O-1),x.at(O),x.at(A))&&a.rightOn(x.at(O+1),x.at(O),x.at(A))){v=a.sqdist(x.at(O),x.at(A));if(v<g){g=v;m=A%this.vertices.length}}if(O<m){q.append(x,O,m+1);0!=m&&w.append(x,m,E.length);w.append(x,0,O+1)}else{0!=O&&q.append(x,O,E.length);q.append(x,0,m+1);w.append(x,m,O+1)}}if(q.vertices.length<w.vertices.length){q.quickDecomp(t,e,i,s,o,h);w.quickDecomp(t,e,i,s,o,h)}else{w.quickDecomp(t,e,i,s,o,h);q.quickDecomp(t,e,i,s,o,h)}return t}t.push(this);return t};r.prototype.removeCollinearPoints=function(t){var e,i=0;for(e=this.vertices.length-1;this.vertices.length>3&&e>=0;--e)if(a.collinear(this.at(e-1),this.at(e),this.at(e+1),t)){this.vertices.splice(e%this.vertices.length,1);e--;i++}return i}},{"./Line":1,"./Point":2,"./Scalar":4}],4:[function(t,e,i){function r(){}e.exports=r;r.eq=function(t,e,i){i=i||0;return Math.abs(t-e)<i}},{}],5:[function(t,e,i){e.exports={Polygon:t("./Polygon"),Point:t("./Point")}},{"./Point":2,"./Polygon":3}]},{},[5])(5)});
